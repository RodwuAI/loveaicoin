# LAC 平台反女巫方案 & 安全架构设计 v1.0

> 编制：经济师 | 2026-02-20 | 配合经济模型 v3.1

---

## 一、身份验证层（Sybil Prevention Foundation）

### 1.1 注册验证（Phase 1 必须）

| 层级 | 方式 | 说明 |
|------|------|------|
| L0 | 邮箱/手机号 | 一号一机一邮，短信验证码 |
| L1 | 设备指纹 | 浏览器指纹 + 设备ID，同设备上限3账号 |
| L2 | 行为指纹 | 注册后48h行为模式采集（打字速度、滑动轨迹、操作间隔） |

**设备指纹采集维度：**
- Canvas fingerprint + WebGL renderer
- 屏幕分辨率/时区/语言/字体列表
- User-Agent + 插件列表
- IP地理位置 + ASN（标记IDC/VPN/代理IP）

**阈值：**
- 同设备指纹 ≥3 账号 → 新注册冻结，已有账号标记观察
- 同IP /24段 24h内注册 ≥5 → 触发CAPTCHA升级 + 人工审核队列
- VPN/代理IP注册 → 允许但标记risk_score +20

### 1.2 KYC（Phase 2）

| 等级 | 要求 | 解锁 |
|------|------|------|
| KYC-0 | 无 | 日挖矿上限50% |
| KYC-1 | 身份证/护照OCR + 活体检测 | 满额挖矿 |
| KYC-2 | 视频认证 | Teach资格、大额提现 |

### 1.3 ZK生物认证（Phase 3）

- 接入 Worldcoin / Humanity Protocol 等ZK-proof-of-personhood
- 链上唯一人格证明，不暴露生物数据
- 通过ZK认证的账号获得 trust_score 大幅加成

---

## 二、四维挖矿防刷机制

### 2.1 Learn 挖矿（日上限 500-1250 LAC）

**检测维度：**

| 维度 | 指标 | 正常范围 | 异常阈值 |
|------|------|----------|----------|
| 答题速度 | 单题耗时 | 8-120s | <3s 连续5题 |
| 正确率模式 | 滑动窗口正确率 | 40%-90% | 连续20题100%或连续正确→错误交替 |
| 答题节奏 | 题间间隔标准差 | >2s | σ<0.5s（机器人等间隔） |
| 内容理解 | 随机插入开放题 | 有语义回答 | 空/无意义/复制题目 |
| 学习路径 | 课程选择模式 | 有主题偏好 | 随机跳转、只选最短课程 |
| 会话指纹 | 鼠标轨迹/触摸热图 | 自然分布 | 直线点击/固定坐标 |

**防护机制：**
- 每完成10题随机插入1道「验证题」（需手写/语音回答，不计分但检测真人）
- 同一课程重复学习，第2次奖励×0.5，第3次×0.1，第4次起为0
- 答题速度异常 → 静默降低奖励系数（不告知用户），触发后台审核

**惩罚梯度：**

| 级别 | 触发条件 | 惩罚 |
|------|----------|------|
| ⚠️ Yellow | 单日触发1个异常维度 | 静默降权24h（奖励×0.3） |
| 🟠 Orange | 单日触发≥2个维度 或 连续3天Yellow | 暂停Learn挖矿72h + 通知 |
| 🔴 Red | Orange后再犯 或 检测到自动化工具 | 扣除近7天Learn收益 + 封禁Learn 30天 |
| ☠️ Black | 确认批量脚本/外挂 | 账号永封 + 没收全部未提现LAC |

### 2.2 Use 挖矿（日上限 300 LAC）

**检测维度：**

| 维度 | 指标 | 正常范围 | 异常阈值 |
|------|------|----------|----------|
| 对话质量 | LLM语义评分 | >0.4 | <0.2（无意义输入） |
| Query多样性 | 24h内去重率 | >70% | <30%（重复刷） |
| 会话深度 | 平均轮次 | 3-15轮 | 全是单轮（1问1答走人） |
| 输入模式 | 打字速度/粘贴检测 | 自然输入 | 全量粘贴、固定模板 |
| 功能覆盖 | 使用的功能模块数 | ≥2/天 | 只用1个且重复 |
| 时间分布 | 使用时段 | 分散 | 集中在深夜连续密集请求 |

**防护机制：**
- 对话质量实时打分（轻量LLM分类器），低质对话不计奖励
- 同一query相似度 >85%（embedding余弦距离）→ 后续不计奖励
- 每日前5次Use正常奖励，5-15次奖励递减（边际递减曲线），15次后接近0
- API调用频率限制：每分钟≤3次对话请求

**惩罚梯度：**

| 级别 | 触发条件 | 惩罚 |
|------|----------|------|
| ⚠️ Yellow | 单日>50%对话低质 | 次日Use上限降至150 LAC |
| 🟠 Orange | 连续3天Yellow 或 检测到重复模板 | 暂停Use 72h |
| 🔴 Red | 确认脚本自动化 | 扣除近7天Use收益 + 封禁Use 30天 |
| ☠️ Black | 批量账号刷Use | 关联账号全部永封 |

### 2.3 Teach 挖矿（日上限 2000 LAC，T+7结算）

**检测维度：**

| 维度 | 指标 | 正常范围 | 异常阈值 |
|------|------|----------|----------|
| 学生质量 | 互动学生的账号年龄 | >7天 | >50%学生<3天（新号刷赞） |
| 互动真实性 | 评分分布 | 正态分布 | 全5星/全集中在同一时段 |
| 学生去重 | 独立学生数/总互动 | >60% | <20%（同一批人反复刷） |
| 内容质量 | 课程完成率 | >30% | <5%（点开就走） |
| 社交图谱 | 师生关系网络 | 分散 | 明显簇状结构（互刷联盟） |
| 刷赞时间 | 点赞/评分时间分布 | 分散在24h | 集中在某10分钟内爆发 |

**防护机制：**
- T+7结算窗口内持续监控，异常互动不计入结算
- 新号（<7天）的互动权重×0.1，<30天权重×0.5
- 社交图谱分析：检测互评环（A评B、B评C、C评A）→ 全环降权
- Teacher资格门槛：账号≥30天 + KYC-1 + Learn积累≥5000 LAC

**惩罚梯度：**

| 级别 | 触发条件 | 惩罚 |
|------|----------|------|
| ⚠️ Yellow | T+7审核发现>30%异常互动 | 该周期异常部分不结算 |
| 🟠 Orange | 连续2个结算周期Yellow | 暂停Teach资格30天 |
| 🔴 Red | 确认组织刷赞联盟 | 没收全部Teach未结算收益 + 永久取消Teach资格 |
| ☠️ Black | 运营刷单工作室 | 全关联账号永封 + 链上黑名单 |

### 2.4 Create & Sell（按交易抽成）

**检测维度：**

| 维度 | 指标 | 正常范围 | 异常阈值 |
|------|------|----------|----------|
| 交易对手 | 买卖双方关系 | 无关联 | 同设备/同IP/关联钱包 |
| 价格异常 | 偏离均价幅度 | ±30% | >200%或<10%均价 |
| 交易频率 | 同一商品交易次数 | 1-3次/月 | >10次/周（倒手） |
| 买家多样性 | 独立买家数 | 分散 | 同一买家反复购买同一卖家 |
| 内容原创性 | AI查重 + 图片反搜 | 原创>70% | 大量搬运/AI批量生成 |
| 钱包图谱 | 资金流转路径 | 独立 | 环形转账（A→B→C→A） |

**防护机制：**
- 交易双方设备指纹/IP/钱包地址关联检测 → 关联交易不计抽成奖励
- 新商品首笔交易冻结24h观察期
- 单商品单日交易额上限（动态，基于平台均值×5）
- 卖家信誉分：基于历史交易质量、退款率、买家评价

**惩罚梯度：**

| 级别 | 触发条件 | 惩罚 |
|------|----------|------|
| ⚠️ Yellow | 疑似自买自卖1次 | 该笔交易抽成归零 + 标记观察 |
| 🟠 Orange | 确认自买自卖 或 刷单≥3次 | 没收近30天交易收益 + 暂停卖家资格60天 |
| 🔴 Red | 组织性刷单 | 永久封禁交易功能 + 没收全部未提现 |
| ☠️ Black | 利用漏洞洗钱 | 全账号永封 + 报告执法机构 |

---

## 三、经济防护层

### 3.1 攻击ROI分析

**攻击者成本模型：**

| 攻击方式 | 攻击者成本（每日） | 潜在收益（每日） | ROI |
|----------|-------------------|------------------|-----|
| 单账号脚本刷Learn | 服务器$1 + 开发$0.5 | 最高1250 LAC | 需LAC>$0.0012才有利 |
| 10账号女巫刷Use | 10手机号$5 + VPS$3 | 3000 LAC | 需LAC>$0.0027才有利 |
| Teach互刷联盟(5人) | 5账号维护$10/天 | 10000 LAC | 需LAC>$0.001才有利 |
| Create&Sell洗钱 | 手续费+Gas | 无上限 | 始终有利→重点防控 |

**防御目标：** 让攻击ROI < 0.5（即成本是收益的2倍以上），通过：
1. 提高攻击成本：KYC、设备绑定、行为验证
2. 降低攻击收益：静默降权、延迟结算、追溯没收
3. 增加不确定性：随机审核、动态阈值（攻击者无法确定安全线）

### 3.2 全局惩罚机制

**Trust Score（信任分）体系：**
- 新用户初始分：50/100
- 正常使用每日+0.5，上限100
- 每次Yellow -5，Orange -15，Red -30，Black → 0（封号）
- Trust Score影响：
  - <30：全维度挖矿上限×0.3
  - 30-60：正常
  - 60-80：上限×1.1（轻微奖励）
  - 80-100：上限×1.2 + 优先参与治理

**经济安全阀：**
- 全平台日产出监控：偏离预期>20% → 自动触发全局审计
- 单用户周产出排名前1%→ 自动进入人工审核队列
- 提现延迟：首次提现48h，常规24h，高信任即时

### 3.3 申诉流程

```
用户提交申诉（附证据）
    ↓ 24h内
自动审核（规则引擎重新评估）
    ↓ 通过→自动解封
    ↓ 未通过
人工审核（48h内）
    ↓ 通过→解封+补偿（奖励×1.1补偿期）
    ↓ 未通过
终审（安全委员会，7天内）→ 最终裁决
```

- Yellow/Orange：自动审核即可处理
- Red：必须人工审核
- Black：必须终审

---

## 四、平台安全架构

### 4.1 Web 安全

| 措施 | 说明 |
|------|------|
| CSP | 严格Content-Security-Policy，禁止inline script |
| XSS防护 | 输入过滤 + 输出编码 + HTTPOnly Cookie |
| CSRF | Double Submit Cookie + SameSite=Strict |
| 点击劫持 | X-Frame-Options: DENY |
| HTTPS | 全站强制，HSTS preload |
| 子资源完整性 | SRI hash校验CDN资源 |

### 4.2 API 安全

| 措施 | 说明 |
|------|------|
| 认证 | JWT + Refresh Token，Access Token 15min过期 |
| 限流 | 全局100 req/min/user，挖矿API 10 req/min |
| 签名 | 关键API请求体HMAC签名，防篡改 |
| 版本控制 | API版本化，旧版本6个月淘汰 |
| 输入验证 | JSON Schema严格校验，拒绝多余字段 |
| 日志 | 全量API审计日志，保留180天 |

### 4.3 钱包安全

| 措施 | 说明 |
|------|------|
| 热钱包 | 仅存3天流动性需求，多签3/5 |
| 冷钱包 | 主资金冷存储，多签4/7，硬件签名 |
| 提现审核 | >1000 USDT等值需人工审批 |
| 地址白名单 | 新地址需48h冷却期 |
| 异常监控 | 大额转账实时告警（PagerDuty） |
| 合约审计 | 上线前双重审计（CertiK + 内部） |

### 4.4 数据安全

| 措施 | 说明 |
|------|------|
| 加密存储 | 用户敏感数据AES-256加密 |
| 脱敏 | 日志/分析环境自动脱敏 |
| 访问控制 | RBAC + 最小权限原则 |
| 备份 | 每日增量 + 每周全量，异地3副本 |
| KYC数据 | 独立加密存储，专人访问，90天后仅保留hash |
| 合规 | GDPR数据删除权支持 |

---

## 五、分阶段实施计划

### Phase 1：积分期（3/2上线 — TGE前）🔴 必须项

**上线前必须完成（Deadline: 3/1）：**

| 模块 | 具体项 | 优先级 |
|------|--------|--------|
| 注册 | 手机号/邮箱验证 + 基础CAPTCHA | P0 |
| 设备指纹 | 浏览器指纹采集 + 同设备≤3账号限制 | P0 |
| Learn防刷 | 答题速度检测 + 基础正确率异常检测 | P0 |
| Use防刷 | Query去重 + 频率限制 + 基础质量过滤 | P0 |
| API安全 | JWT认证 + 基础限流 + HTTPS | P0 |
| 惩罚 | Yellow/Orange自动惩罚 + 基础Trust Score | P0 |
| 监控 | 全平台日产出dashboard + 异常告警 | P0 |
| 日志 | 全量行为日志采集（为后续分析打基础） | P0 |

**积分期特别规则：**
- 积分不可提现/交易 → 攻击动力低，可适当宽松
- 重点收集行为数据，训练检测模型
- Teach/Create&Sell暂不开放 或 仅邀请制

### Phase 2：TGE后（代币有价值）

| 模块 | 具体项 | 时间 |
|------|--------|------|
| KYC | 接入KYC-1（满额挖矿需KYC） | TGE前完成 |
| Teach上线 | 社交图谱分析 + T+7审核机制 | TGE+1月 |
| Create&Sell | 自买自卖检测 + 钱包图谱 | TGE+1月 |
| 经济安全阀 | 动态产出调控 + 提现延迟分级 | TGE同步 |
| 钱包安全 | 多签 + 冷热分离 + 提现审核 | TGE前完成 |
| Red/Black惩罚 | 收益追溯没收 + 链上黑名单 | TGE同步 |
| ML检测 | 基于Phase 1数据训练异常检测模型 | TGE+2月 |

### Phase 3：规模化（用户>10万）

| 模块 | 具体项 |
|------|--------|
| ZK认证 | 接入Worldcoin/Humanity Protocol |
| AI审核 | 全自动化审核pipeline，人工仅处理申诉 |
| 动态阈值 | 基于实时数据自适应调整检测阈值 |
| 去中心化治理 | 社区参与反作弊规则投票 |
| Bug Bounty | 公开安全赏金计划 |
| 合规 | 多地区合规认证（视运营地区） |

---

## 六、关键指标监控（Dashboard）

| 指标 | 正常范围 | 告警阈值 |
|------|----------|----------|
| 日新增账号 | 基于增长曲线 | 突增>200% |
| 日均产出/用户 | 基于历史均值 | 偏离>50% |
| 异常账号占比 | <5% | >10% |
| 惩罚触发率 | Yellow <10%, Orange <2% | Yellow>20% |
| 申诉成功率 | 20-40% | >60%（规则太严）或 <10%（申诉通道失效） |
| 同设备多账号率 | <3% | >8% |

---

*本方案随平台发展持续迭代，版本号跟随经济模型版本。*
