# LAC平台安全Checklist V1.0

> 编制：小黑🔒 (安全负责人)
> 版本：V1.0
> 日期：2026年2月21日
> 适用版本：白皮书V2.0 (含交易中心、游戏化引擎、社交系统)
> 参考文档：
>   - `security-plan-v1.md` (安全方案V1.0)
>   - `whitepaper-v2.md` (白皮书V2.0)
>   - `solana-contract-plan-v1.md` (Solana合约方案V1.0)

---

## 概述

本Checklist基于白皮书V2.0新增功能（交易中心、游戏化引擎、社交系统）扩展安全要求，按照**开发阶段**分为三段：

1. **开发期安全** — 代码审查标准、依赖审计、环境隔离
2. **上线前安全** — 合约审计、渗透测试、压力测试清单
3. **运营期安全** — 监控、告警、应急响应、热更新流程

每个检查项包含：
- **检查项名称**
- **优先级** (P0/P1/P2)：P0为上线必备，P1为上线后1个月内完成，P2为上线后3个月内完成
- **负责人**：角色/团队
- **验收标准**：具体可验证的标准
- **当前状态**：⬜待做 / 🟡进行中 / ✅已完成

---

## 一、开发期安全 (Development Security)

**目标**：在开发阶段预防安全漏洞，确保代码质量和环境安全。

### 1.1 代码审查标准

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 智能合约代码审查 | P0 | 链鹰 + 小黑 | 1. 所有合约代码通过Rust安全工具（cargo-audit, cargo-deny）扫描无高风险漏洞<br>2. 关键函数（转账、权限修改、销毁）必须有详细注释和安全说明<br>3. 所有外部调用（跨合约调用）必须进行重入攻击防护（Solana账户模型下仍需检查） | ⬜待做 |
| 前端钱包交互安全审查 | P0 | 小技 + 小黑 | 1. 所有钱包连接（Phantom/Solflare）使用官方SDK，禁止自定义不安全的连接方法<br>2. 交易签名前必须有明确的风险提示（金额、接收方、手续费）<br>3. 私钥/助记词绝对禁止在前端存储或传输 | ⬜待做 |
| 交易中心功能代码审查 | P0 | 小小技 + 小黑 | 1. 拍卖合约必须防止前端价格操纵（如最后时刻狙击）<br>2. NFT铸造必须检查元数据完整性（防止恶意元数据）<br>3. 交易手续费计算必须防止整数溢出 | ⬜待做 |
| 游戏化引擎防作弊代码审查 | P0 | 小小技 + 小黑 | 1. 成就系统必须有防刷逻辑（同一行为不能重复触发同一成就）<br>2. 排行榜数据必须后端验证，禁止前端直接提交排名<br>3. 赛季结算必须在链上或可信后端进行，防止篡改 | ⬜待做 |
| 社交系统安全审查 | P0 | 小小技 + 小黑 | 1. 师徒系统必须防止循环绑定（A是B的师傅，B又是A的师傅）<br>2. 团队挖矿必须有成员活跃度验证，防止僵尸团队<br>3. 社区投票必须防止一人多票（基于LAC持有量快照） | ⬜待做 |

### 1.2 依赖审计

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| Node.js依赖安全扫描 | P0 | 小技 | 1. 使用npm audit或yarn audit扫描，无Critical/High漏洞<br>2. 所有依赖版本固定（lockfile），禁止使用松散版本范围 | ⬜待做 |
| Solana程序依赖审计 | P0 | 链鹰 | 1. Cargo.toml中所有crate必须来自官方crates.io或可信源<br>2. 禁止使用未经审计的第三方Solana程序库（除非社区广泛使用） | ⬜待做 |
| 前端框架漏洞检查 | P0 | 小技 | 1. React/Next.js版本必须是最新稳定版或至少LTS版本<br>2. 检查是否存在已知的XSS/CSRF相关漏洞 | ⬜待做 |
| AI服务API依赖安全 | P1 | 小小技 | 1. 所有AI服务（OpenAI/Claude等）API密钥必须存储在环境变量，禁止硬编码<br>2. API调用必须设置速率限制和超时，防止滥用 | ⬜待做 |

### 1.3 环境隔离

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 开发/测试/生产环境隔离 | P0 | 小小技 | 1. 数据库、缓存、消息队列完全隔离，无共用实例<br>2. 私钥、API密钥按环境分离，测试环境使用假数据 | ⬜待做 |
| 智能合约测试网络配置 | P0 | 链鹰 | 1. 开发使用Devnet，测试使用Testnet，生产使用Mainnet Beta<br>2. 测试网络代币与主网代币严格区分，无交叉风险 | ⬜待做 |
| 钱包测试环境 | P0 | 小技 | 1. 前端开发环境连接测试网络钱包（如Phantom Testnet模式）<br>2. 禁止在开发环境使用真实资金的钱包 | ⬜待做 |
| 数据隔离（GDPR准备） | P1 | 小小技 | 1. 用户个人数据（邮箱、手机号）与其他业务数据逻辑隔离<br>2. 支持按用户ID完全删除所有个人数据（软删除+硬删除流程） | ⬜待做 |

---

## 二、上线前安全 (Pre‑Launch Security)

**目标**：在项目上线前进行全面安全验证，确保无重大漏洞。

### 2.1 合约审计

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| LAC代币合约审计 | P0 | 链鹰 + 小黑 | 1. 通过至少一家专业审计机构（如OtterSec, CertiK）审计并出具报告<br>2. 审计报告中所有Critical/High问题必须修复并验证 | ⬜待做 |
| 挖矿奖励分发合约审计 | P0 | 链鹰 + 小黑 | 1. Merkle Distributor合约必须审计，防止重放攻击、无效证明<br>2. 奖励计算逻辑必须与白皮书一致，防止溢出或精度错误 | ⬜待做 |
| 交易市场合约审计 | P0 | 链鹰 + 小黑 | 1. 市场合约必须审计，防止价格操纵、恶意上架<br>2. 拍卖合约必须审计，防止时间狙击、出价伪造 | ⬜待做 |
| NFT合约审计 | P0 | 链鹰 + 小黑 | 1. NFT铸造合约必须审计，防止无限铸造、元数据劫持<br>2. 版税机制必须审计，确保每次转手自动分配 | ⬜待做 |
| 质押合约审计（如有） | P1 | 链鹰 | 1. 质押奖励计算必须安全，防止重入、利息计算错误<br>2. 解押延迟机制必须防止闪电贷攻击 | ⬜待做 |

### 2.2 渗透测试

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| Web应用渗透测试 | P0 | 小黑 + 外部团队 | 1. 完成OWASP Top 10漏洞扫描，无Critical/High漏洞<br>2. 重点测试钱包连接、交易签名、用户登录等关键路径 | ⬜待做 |
| API渗透测试 | P0 | 小黑 + 外部团队 | 1. 所有API端点必须经过身份验证、授权测试<br>2. 频率限制必须有效，防止API滥用 | ⬜待做 |
| 交易中心功能渗透测试 | P0 | 小黑 + 外部团队 | 1. 测试拍卖机制是否可被前端操纵（如修改时间、价格）<br>2. 测试NFT铸造是否可上传恶意文件或元数据 | ⬜待做 |
| 游戏化系统渗透测试 | P0 | 小黑 + 外部团队 | 1. 测试成就系统是否可通过重复请求刷成就<br>2. 测试排行榜是否可通过伪造数据提升排名 | ⬜待做 |
| 社交系统渗透测试 | P1 | 小黑 | 1. 测试师徒系统是否可创建循环关系或超限绑定<br>2. 测试团队挖矿是否可通过僵尸账号刷加成 | ⬜待做 |

### 2.3 压力测试清单

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 并发挖矿请求压力测试 | P0 | 小小技 | 1. 模拟1000用户同时进行Learn/Use挖矿，系统响应时间<2s，错误率<1%<br>2. 数据库连接池无泄漏，CPU/内存使用率<80% | ⬜待做 |
| 交易市场高并发测试 | P0 | 小小技 | 1. 模拟100用户同时上架、购买、拍卖，交易成功率>99%<br>2. 链上交易Gas费波动不影响功能 | ⬜待做 |
| Solana网络拥堵测试 | P0 | 链鹰 | 1. 在Solana网络拥堵时（如TPS下降），测试平台降级方案<br>2. 合约调用必须有超时和重试机制 | ⬜待做 |
| DDoS防护测试 | P1 | 小小技 | 1. 配置WAF（如Cloudflare）并测试防护规则是否生效<br>2. 关键API必须设置IP频率限制 | ⬜待做 |

### 2.4 资金安全验证

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 多签钱包配置验证 | P0 | 链鹰 + 小算盘 | 1. 主多签（3/5）和运营多签（2/3）已通过Squads Protocol配置<br>2. 所有成员已确认并测试签名流程 | ⬜待做 |
| 热钱包资金限额验证 | P0 | 小算盘 | 1. 热钱包仅保留3天运营资金，其余在冷钱包或多签<br>2. 大额提现（>1000 USDT等值）需人工审批流程已就绪 | ⬜待做 |
| 初始流动性锁定验证 | P0 | 链鹰 | 1. Raydium LP Token已通过Streamflow LP Locker锁定12个月<br>2. 锁定交易哈希已公示在官网 | ⬜待做 |
| 提现审核流程测试 | P0 | 小算盘 + 小黑 | 1. 模拟提现请求，验证人工审核流程（邮件/钉钉通知）<br>2. 异常提现（新地址、大额）必须触发告警 | ⬜待做 |

---

## 三、运营期安全 (Operational Security)

**目标**：在项目上线后持续监控、响应安全事件，保障平台稳定运行。

### 3.1 监控与告警

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 异常挖矿行为监控 | P0 | 小黑 + 经济师 | 1. 实时监控用户挖矿产出，单用户产出>日均3σ自动告警<br>2. 监控同一设备/IP多账号挖矿模式 | ⬜待做 |
| 交易市场异常监控 | P0 | 小黑 | 1. 监控异常价格交易（偏离均价>200%或<10%）<br>2. 监控自买自卖模式（同一设备/IP买卖双方） | ⬜待做 |
| 合约资金流动监控 | P0 | 链鹰 + 小算盘 | 1. 监控合约大额资金流出（>10,000 LAC）<br>2. 监控可疑地址（新地址、黑名单地址）交易 | ⬜待做 |
| 游戏化系统作弊监控 | P0 | 小黑 | 1. 监控成就刷取行为（同一成就短时间内重复触发）<br>2. 监控排行榜异常上升（短时间内排名大幅提升） | ⬜待做 |
| 社交系统滥用监控 | P1 | 小黑 | 1. 监控师徒系统绑定解绑频率（防止刷师傅奖励）<br>2. 监控团队挖矿僵尸成员（连续7天无活跃） | ⬜待做 |

### 3.2 应急响应

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 安全事件响应流程（SOP） | P0 | 小黑 | 1. 编写安全事件分类（Critical/High/Medium/Low）及响应时间要求<br>2. 建立安全事件上报通道（Telegram群、邮件、钉钉） | ⬜待做 |
| 合约漏洞应急响应 | P0 | 链鹰 + 小黑 | 1. 准备合约紧急暂停（Pausable）流程，多签成员知晓如何操作<br>2. 准备资金迁移预案（如漏洞导致资金风险） | ⬜待做 |
| 前端被黑应急响应 | P0 | 小技 + 小黑 | 1. 准备静态资源备份和快速切换CDN流程<br>2. 准备域名冻结和转移流程 | ⬜待做 |
| 数据泄露应急响应 | P0 | 小小技 + 小黑 | 1. 准备用户通知模板（邮件、公告）<br>2. 准备密码重置、会话失效流程 | ⬜待做 |
| 女巫攻击大规模爆发响应 | P1 | 经济师 + 小黑 | 1. 准备临时提高KYC等级、降低挖矿上限等经济调节措施<br>2. 准备社区公告解释和安抚话术 | ⬜待做 |

### 3.3 热更新流程

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 前端热更新流程 | P0 | 小技 | 1. 前端静态资源部署有版本控制和回滚机制（如Cloudflare Pages）<br>2. 更新前必须在测试环境验证，更新后监控错误率 | ⬜待做 |
| 后端API热更新流程 | P0 | 小小技 | 1. 采用蓝绿部署或金丝雀发布，确保零停机<br>2. 数据库迁移必须有回滚脚本 | ⬜待做 |
| 合约升级流程（如支持） | P1 | 链鹰 | 1. 合约升级必须通过多签投票，并在测试网充分测试<br>2. 升级前必须通知社区（如治理投票） | ⬜待做 |
| 配置热更新流程 | P1 | 小小技 | 1. 关键配置（如挖矿奖励系数、手续费率）必须支持运行时更新<br>2. 配置变更必须记录审计日志 | ⬜待做 |

### 3.4 合规与数据保护

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| GDPR数据删除流程 | P1 | 小小技 + 小黑 | 1. 用户请求删除数据时，能够删除所有个人数据（邮箱、手机号、IP）<br>2. 删除后保留匿名化数据用于分析 | ⬜待做 |
| KYC数据安全存储 | P0 | 小算盘 + 小黑 | 1. KYC数据（身份证、护照）加密存储，访问日志完整<br>2. KYC数据90天后自动删除原始文件，仅保留哈希 | ⬜待做 |
| 用户数据访问日志 | P1 | 小小技 | 1. 所有用户敏感数据访问（如查看用户信息）必须有日志记录<br>2. 日志保留180天，定期审计异常访问 | ⬜待做 |
| 法律合规风险评估 | P2 | 财奴 + 小黑 | 1. 评估目标运营地区（如美国、欧盟、中国）的合规要求<br>2. 准备应对监管问询的文档材料 | ⬜待做 |

---

## 四、重点关注领域专项检查

### 4.1 交易中心资金安全

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 购买流程资金安全 | P0 | 链鹰 + 小技 | 1. 用户购买商品时，LAC必须直接转入平台托管合约，而非卖家地址<br>2. 托管合约必须确保"钱货两清"才释放资金 | ⬜待做 |
| 拍卖防狙击机制 | P0 | 链鹰 + 小技 | 1. 拍卖最后5分钟有新出价自动延时5分钟<br>2. 出价必须高于当前价+最小加价（5%或50 LAC） | ⬜待做 |
| NFT版税强制执行 | P0 | 链鹰 | 1. NFT合约必须集成版税标准（如Metaplex），确保二级市场自动分润<br>2. 测试在第三方市场（Magic Eden）转手是否依然有效 | ⬜待做 |
| 手续费分配安全 | P0 | 链鹰 + 小算盘 | 1. 平台手续费（10-15%）必须按规则分配（50%销毁、30%运营、20%创作者池）<br>2. 分配过程必须可审计（链上交易或公开报表） | ⬜待做 |

### 4.2 挖矿防作弊（扩展版）

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 游戏化成就防刷 | P0 | 小小技 + 小黑 | 1. 成就触发必须后端验证，禁止前端直接调用<br>2. 同一成就24小时内只能触发一次（除非明确设计可重复） | ⬜待做 |
| 排行榜数据真实性 | P0 | 小小技 + 小黑 | 1. 排行榜数据必须来自可信后端，禁止用户提交排名<br>2. 赛季结算时必须验证用户数据未被篡改 | ⬜待做 |
| 赛季通行证防刷 | P0 | 小小技 + 小黑 | 1. 通行证经验获取必须与真实行为绑定（学习、使用、教导）<br>2. 检测异常经验获取模式（如短时间内暴涨） | ⬜待做 |
| 团队挖矿防僵尸 | P1 | 小小技 + 小黑 | 1. 团队成员必须每周至少3天有挖矿行为，否则自动踢出<br>2. 团队加成必须基于真实贡献，防止一人贡献全队享受 | ⬜待做 |

### 4.3 钱包连接安全

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 钱包钓鱼防护 | P0 | 小技 + 小黑 | 1. 网站必须启用HTTPS，且证书有效<br>2. 钱包连接时必须显示平台官方名称和图标，防止钓鱼网站 | ⬜待做 |
| 交易签名提示清晰 | P0 | 小技 | 1. 用户签名前必须明确显示交易类型（购买、拍卖、转账）<br>2. 显示金额、接收方、手续费，防止恶意合约 | ⬜待做 |
| 钱包连接会话安全 | P0 | 小技 | 1. 会话过期时间合理（如24小时），支持手动断开<br>2. 禁止在前端存储任何钱包敏感信息 | ⬜待做 |
| 多钱包支持安全 | P1 | 小技 | 1. 支持Phantom、Solflare、Backpack等主流钱包，使用官方SDK<br>2. 钱包切换时必须重新验证权限 | ⬜待做 |

### 4.4 Solana合约漏洞专项

| 检查项名称 | 优先级 | 负责人 | 验收标准 | 当前状态 |
|------------|--------|--------|----------|----------|
| 重入攻击防护 | P0 | 链鹰 | 1. 尽管Solana账户模型不同，仍需检查跨程序调用是否存在状态竞争<br>2. 使用Solana的CPI（Cross‑Program Invocation）安全模式 | ⬜待做 |
| 整数溢出检查 | P0 | 链鹰 | 1. 所有算术运算使用Rust的checked_*系列函数（checked_add, checked_mul）<br>2. 奖励计算、手续费计算必须测试极端值 | ⬜待做 |
| 权限控制验证 | P0 | 链鹰 | 1. 每个合约函数必须明确所需权限（如仅管理员、仅持有者）<br>2. 权限变更必须通过多签或治理投票 | ⬜待做 |
| 初始代币分配安全 | P0 | 链鹰 | 1. 代币Mint权限在初始化后必须永久关闭（Renounce Mint Authority）<br>2. 初始分配必须通过Vesting合约，防止团队突然抛售 | ⬜待做 |

---

## 五、Checklist使用说明

1. **责任人分配**：每个检查项必须指定具体负责人（角色），实际执行时可细化到个人。
2. **优先级定义**：
   - **P0**：上线必备，未完成不得上线。
   - **P1**：上线后1个月内必须完成。
   - **P2**：上线后3个月内必须完成。
3. **状态更新**：每周安全会议更新状态，从“⬜待做”改为“🟡进行中”或“✅已完成”。
4. **验收标准**：完成时必须提供证据（如审计报告、测试截图、监控告警截图）。
5. **持续迭代**：本Checklist随平台发展定期更新，新增功能需补充相应检查项。

---

## 六、附录

### 6.1 参考安全工具清单

- **智能合约审计工具**：cargo-audit, cargo-deny, Solana CLI安全检查
- **Web渗透测试工具**：OWASP ZAP, Burp Suite, Nmap
- **依赖扫描工具**：npm audit, yarn audit, Snyk, Dependabot
- **监控告警工具**：Prometheus + Grafana, Sentry, PagerDuty
- **日志审计工具**：ELK Stack (Elasticsearch, Logstash, Kibana), Splunk

### 6.2 紧急联系人列表

| 角色 | 紧急联系方式 | 备份联系方式 |
|------|-------------|-------------|
| 安全负责人（小黑） | Telegram: @xiaohei | 邮件: security@lac.ai |
| Web3架构师（链鹰） | Telegram: @lianying | 邮件: web3@lac.ai |
| 后端负责人（小小技） | Telegram: @xiaoxiaoji | 邮件: backend@lac.ai |
| 前端负责人（小技） | Telegram: @xiaoji | 邮件: frontend@lac.ai |
| 财务负责人（小算盘） | Telegram: @xiaosuanpan | 邮件: finance@lac.ai |

---

**文档版本控制：**

| 版本 | 日期 | 变更说明 | 编制人 |
|------|------|----------|--------|
| V1.0 | 2026-02-21 | 初始版本，基于白皮书V2.0新增功能 | 小黑🔒 |
|      |          |          |        |

**下一步行动：**
1. 各负责人认领检查项，制定具体执行计划。
2. 每周安全会议汇报进展，更新状态。
3. 上线前完成所有P0项，并提供验收证据。