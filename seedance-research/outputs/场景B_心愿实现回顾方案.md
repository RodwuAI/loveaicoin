# 心愿实现回顾方案详解
## TimeRedeem Seedance 2.0 场景B实施方案

**版本**: v1.0  
**更新日期**: 2026年2月15日

---

## 一、场景概述

### 1.1 核心概念

心愿实现回顾是**全自动化的视频生成服务**：
- 粉丝心愿完成后，系统自动触发视频生成
- 整合名人素材 + 粉丝心愿 + 实现过程
- 生成专属回顾视频，自动推送给用户

### 1.2 业务流程

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  心愿完成   │────▶│  系统触发   │────▶│  素材聚合   │
└─────────────┘     └─────────────┘     └──────┬──────┘
                                                │
                       ┌────────────────────────┘
                       ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  用户收到   │◀────│  视频合成   │◀────│  AI脚本生成  │
│  回顾视频   │     └─────────────┘     └─────────────┘
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  分享传播   │
└─────────────┘
```

### 1.3 核心价值

| 价值点 | 说明 |
|-------|------|
| **零人工** | 全自动流程，边际成本趋近于零 |
| **即时性** | 心愿完成后15分钟内交付 |
| **情感连接** | 强化粉丝与平台/名人的纽带 |
| **社交裂变** | 优质内容驱动自然传播 |

---

## 二、自动化工作流设计

### 2.1 触发机制

```yaml
触发条件:
  主条件: 心愿订单状态 = "已完成"
  延迟时间: 15分钟（预留素材上传时间）
  优先级: FIFO（先进先出）
  并发限制: 5个/批次

异常处理:
  素材缺失: 延迟30分钟重试
  生成失败: 自动重试2次，后转人工
  质量不合格: 触发重新生成
```

### 2.2 素材聚合逻辑

| 素材类型 | 来源 | 匹配规则 | 优先级 |
|---------|------|---------|--------|
| 名人素材 | 预存素材库 | 按心愿类型匹配 | P0 |
| 粉丝心愿 | 订单数据 | 提取心愿文本 | P0 |
| 实现过程 | 履约录像 | 自动归档关联 | P1 |
| 背景音乐 | 授权曲库 | 按情绪标签匹配 | P2 |
| 场景模板 | 平台模板库 | 按主题匹配 | P2 |

### 2.3 自动化流水线

```
┌─────────────────────────────────────────────────────────────┐
│                   心愿回顾自动化流水线                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  [触发器] ──▶ [素材聚合] ──▶ [脚本生成] ──▶ [分段生成]       │
│      │           │              │             │             │
│      ▼           ▼              ▼             ▼             │
│  状态变更    名人素材       LLM生成      3段并行生成          │
│              粉丝心愿       回顾脚本      (片头/主体/结尾)     │
│              履约片段                                       │
│                                                             │
│  [质量检测] ◀── [智能合成] ◀── [分段生成结果]                │
│      │                                                          │
│      ▼           ┌──────────┐                               │
│  AI视觉评分  ──▶ │ 通过?    │                               │
│  人工抽检        └────┬─────┘                               │
│                  Yes │ No                                   │
│                      ▼                                      │
│              ┌───────┴───────┐                              │
│              ▼               ▼                              │
│        [用户交付]      [重新生成]                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、分段视频生成策略

### 3.1 三段式结构

由于Seedance 2.0单次生成最长15秒，采用分段策略：

| 段落 | 时长 | 内容 | 运镜 | 情绪曲线 |
|-----|------|------|------|---------|
| **片头** | 3-5秒 | 心愿标题+名人引入 | 固定→缓慢推入 | 好奇、期待 |
| **主体** | 7-9秒 | 心愿实现精彩片段 | 跟随+环绕+特写 | 兴奋、感动 |
| **结尾** | 3-5秒 | 感谢+品牌露出 | 拉远淡出 | 温暖、回味 |

### 3.2 分段提示词模板

#### 片头段（3-5秒）

```markdown
【场景】温馨室内，{{celebrity_name}}准备向{{fan_name}}传递惊喜

【动作】
{{celebrity_name}}面向镜头，眼神温和，做出"我有个惊喜给你"的表情

【运镜】
固定镜头2秒，然后缓慢推入至中景

【风格】
温暖自然光，生活纪实风格，色调柔和

【参考】
@图片1 {{celebrity_name}}正面照
@文字 "心愿：{{wish_content}}"

【参数】
分辨率：1080p | 时长：4秒 | 风格：Documentary
```

#### 主体段（7-9秒）

```markdown
【场景】{{scene_setting}}，心愿实现现场

【动作】
{{celebrity_name}}与{{fan_name}}互动，
可以是拥抱/击掌/赠送礼物/对话，展现真实情感

【运镜】
0-3秒：跟随动作，中景拍摄
3-6秒：环绕拍摄，展现互动细节
6-9秒：定格在温馨瞬间，特写表情

【风格】
动感跟拍，真实记录，情绪饱满

【参考】
@视频1 履约现场录像精华片段
@图片2-4 精选互动画面

【参数】
分辨率：1080p | 时长：9秒 | 风格：Documentary Dynamic
```

#### 结尾段（3-5秒）

```markdown
【场景】{{celebrity_name}}面向镜头致谢

【动作】
微笑致谢，可以配合比心/点赞/眨眼等可爱动作

【运镜】
缓慢拉远，最后定格在品牌Logo区域

【风格】
温暖收尾，品牌温度

【参考】
@图片5 {{celebrity_name}}致谢表情参考
@图片6 TimeRedeem品牌Logo

【参数】
分辨率：1080p | 时长：4秒 | 风格：Brand Closing
```

### 3.3 视频拼接方案

#### 方案1：Seedance"接着拍"功能
- **优点**：画面连贯性好，过渡自然
- **缺点**：需要按顺序生成，时间较长
- **适用**：对连贯性要求高的场景

#### 方案2：传统剪辑软件拼接
- **优点**：可控性强，可添加转场特效
- **缺点**：需要额外的剪辑步骤
- **适用**：需要品牌包装的场景

**推荐**：方案2 + 预设转场模板，平衡效率与效果

---

## 四、AI脚本生成

### 4.1 提示词工程

```markdown
# LLM脚本生成提示词

你是一位专业的短视频脚本策划师，为粉丝心愿实现视频撰写回顾旁白。

## 输入信息
- 名人姓名：{{celebrity_name}}
- 粉丝昵称：{{fan_name}}
- 心愿内容：{{wish_content}}
- 心愿类型：{{wish_type}}
- 实现日期：{{fulfill_date}}

## 输出要求
1. 撰写15秒的回顾旁白脚本
2. 分3段（片头4秒/主体7秒/结尾4秒）
3. 每段标注时间戳和建议画面
4. 情绪曲线：期待→感动→温暖
5. 语言风格：真诚、温暖、正能量
6. 总字数：60-80字

## 输出格式
```
[片头 0-4秒]
旁白：...
画面建议：...

[主体 4-11秒]
旁白：...
画面建议：...

[结尾 11-15秒]
旁白：...
画面建议：...
```
```

### 4.2 示例输出

```markdown
[片头 0-4秒]
旁白："嘿{{fan_name}}，还记得你的那个心愿吗？"
画面建议：{{celebrity_name}}神秘微笑，背景温馨

[主体 4-11秒]
旁白："今天，我想亲手为你实现它。这一刻，我们一起见证。"
画面建议：心愿实现过程，互动细节，真实情感

[结尾 11-15秒]
旁白："谢谢你让我成为这个美好时刻的一部分，期待下次相见！"
画面建议：{{celebrity_name}}致谢，TimeRedeem品牌露出
```

---

## 五、技术实现架构

### 5.1 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                      用户层                                  │
│                 (Web/App 交互界面)                           │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                      API层                                   │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌──────────┐ │
│  │ 心愿服务   │  │ 素材服务   │  │ 视频服务   │  │ 通知服务  │ │
│  └───────────┘  └───────────┘  └───────────┘  └──────────┘ │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                     服务层                                   │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌──────────┐ │
│  │ 素材聚合   │  │ 脚本生成   │  │ 视频生成   │  │ 质量检测  │ │
│  │  Service  │  │  Service  │  │  Service  │  │ Service  │ │
│  └───────────┘  └───────────┘  └───────────┘  └──────────┘ │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                     任务队列                                 │
│                  (Redis + Celery)                            │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                     外部服务                                 │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐               │
│  │Seedance   │  │  LLM API  │  │  对象存储  │               │
│  │  API      │  │ (GPT-4等) │  │ (OSS/S3)  │               │
│  └───────────┘  └───────────┘  └───────────┘               │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 核心代码示例

```python
class WishReviewVideoService:
    """心愿回顾视频生成服务"""
    
    async def generate_wish_review(self, wish_id: str) -> VideoResult:
        """生成心愿回顾视频"""
        
        # 1. 获取心愿信息
        wish = await self.wish_service.get(wish_id)
        
        # 2. 聚合素材
        assets = await self.aggregate_assets(wish)
        
        # 3. 生成脚本
        script = await self.generate_script(wish, assets)
        
        # 4. 并行生成三段视频
        segments = await asyncio.gather(
            self.generate_segment("opening", script.opening, assets),
            self.generate_segment("body", script.body, assets),
            self.generate_segment("ending", script.ending, assets)
        )
        
        # 5. 质量检测
        for segment in segments:
            score = await self.quality_check(segment)
            if score < 0.8:
                segment = await self.regenerate(segment)
        
        # 6. 合成最终视频
        final_video = await self.compose_video(segments, script.audio)
        
        # 7. 上传存储
        url = await self.upload_to_cdn(final_video)
        
        # 8. 通知用户
        await self.notify_user(wish.user_id, url)
        
        return VideoResult(url=url, duration=15)
    
    async def aggregate_assets(self, wish: Wish) -> Assets:
        """聚合所需素材"""
        return Assets(
            celebrity_photos=await self.celebrity_service.get_photos(wish.celebrity_id),
            fan_photo=wish.fan_photo,
            fulfillment_video=wish.fulfillment_video,
            music=await self.music_service.match(wish.theme)
        )
    
    async def generate_script(self, wish: Wish, assets: Assets) -> Script:
        """使用LLM生成脚本"""
        prompt = self.build_llm_prompt(wish)
        response = await llm_client.chat.completions.create(
            model="gpt-4",
            messages=[{"role": "user", "content": prompt}]
        )
        return self.parse_script(response.choices[0].message.content)
```

---

## 六、质量保障体系

### 6.1 AI质量评分

| 维度 | 权重 | 评分标准 |
|-----|------|---------|
| 画面清晰度 | 20% | 无模糊/噪点 |
| 人物一致性 | 25% | 与参考素材匹配度 |
| 动作自然度 | 20% | 动作流畅无僵硬 |
| 运镜质量 | 15% | 符合预设运镜方案 |
| 风格统一度 | 20% | 三段风格一致 |

**通过标准**：总分≥80分

### 6.2 人工抽检规则

- **抽检比例**：10%（每日首批100%）
- **抽检内容**：画面质量、品牌合规、情感表达
- **不合格处理**：返工重新生成

### 6.3 降级方案

当AI生成连续失败时：
1. 第1次失败：自动重试，调整参数
2. 第2次失败：更换备用模板
3. 第3次失败：使用预录模板视频，人工插入关键帧

---

## 七、性能指标

### 7.1 关键指标

| 指标 | 目标值 | 说明 |
|-----|--------|------|
| 生成成功率 | ≥95% | 一次生成即通过 |
| 平均生成时间 | ≤10分钟 | 从触发到交付 |
| 用户满意度 | ≥4.5/5 | 回顾视频评分 |
| 分享率 | ≥30% | 用户主动分享比例 |

### 7.2 成本指标

| 项目 | 单条成本 | 月成本（5000条） |
|-----|---------|-----------------|
| Seedance API | ¥4.5 | ¥22,500 |
| LLM调用 | ¥0.05 | ¥250 |
| 服务器 | ¥0.2 | ¥1,000 |
| **总计** | **¥4.75** | **¥23,750** |

---

## 八、实施建议

### 8.1 分阶段实施

| 阶段 | 时间 | 目标 |
|-----|------|------|
| **MVP** | 第1-2周 | 手工验证流程，生成20条测试 |
| **自动化** | 第3-4周 | 上线自动化流水线 |
| **优化** | 第5-6周 | 优化生成质量和效率 |
| **规模化** | 第7-8周 | 全量上线，监控运营 |

### 8.2 风险提示

1. **生成质量波动**：建立多重备份机制
2. **名人素材不足**：提前储备，签订长期协议
3. **API稳定性**：准备备选方案（如Runway）

---

**文档维护**：Seedance-Worker  
**更新记录**：
- v1.0 (2026-02-15)：初始版本
